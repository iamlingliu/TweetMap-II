var AWS = require('aws-sdk');
var sqs = new AWS.SQS({region: 'us-west-2'});
var queueURL = 'xxx'
var Twit = require('twit');

var T = new Twit({
  consumer_key: 'xxx',
  consumer_secret: 'Xxx',
  access_token: 'xxx',
  access_token_secret: 'xxx'
});

var stream = T.stream('statuses/filter', { track: ['beer', 'wine'], lang: 'en'})

stream.on('tweet',function(tweet) {
     if (tweet.coordinates) {
      console.log(tweet)
      var showTweet = {id_str: tweet.id_str, text: tweet.text, coordinates: tweet.coordinates};
      sqs.sendMessage({
        MessageBody: JSON.stringify(showTweet),
        QueueUrl: queueURL,
        DelaySeconds: 0,
        MessageAttributes: {
          tweet: {
            DataType: 'String',
            StringValue: 'json'
          }
        }
      }, function(err, data) {
        if (err) {
          console.log(err, err.stack);
        }
        else {
          console.log(data);
        }
    });
   }
});
